# Разрешаем recovery доступ к блочным устройствам и монтированию
allow recovery block_device:dir search;
allow recovery { mmc_blk_device sda_device }:blk_file { read write open getattr mount };
allow recovery untrusted_app_tmpfs:file { read write open };

# Общие разрешения для файловых операций, необходимых для wipe/format
allow recovery self:capability { setuid setgid net_raw net_admin sys_chroot dac_override };

# Ключевые правила для устранения ошибок, блокирующих сброс
allow recovery system_data_file:dir { write add_name remove_name search };
allow recovery system_data_file:file { write create getattr setattr open };
allow recovery self:capability { setuid setgid dac_override };

# Разрешить домену recovery добавлять (регистрировать) сервисы в service_manager
allow recovery service_manager_service:service_manager add;
